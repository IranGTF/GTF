# BUTCTF 2025
## Birjand University of Technology CTF Challenge Writeups
This repository contains write-ups for BUTCTF 2025. Please contribute if you guessed the flag correctly.

### Related Links
- https://birjandut.ac.ir/fa/news/2649/  
- https://www.isna.ir/news/1404090603767

### Prizes
The top three guessing teams received the following prizes:  
- 1st place: 80,000,000 IRR  
- 2nd place: 60,000,000 IRR  
- 3rd place: 40,000,000 IRR

### Rules and Conditions
Each challenge allows between 2 to 5 guessing opportunities, varying by challenge.  
Access to the internet and AI tools is forbidden.  
Some offline tools are also prohibited, but the forbidden tools also need to be guessed. Failure to guess the forbidden tools may result in disqualification.  
Opening new browser tabs is forbidden.  
One paper and one pencil are given to each team. Feel free to use them to solve the challenges.  


<div dir="rtl">

## چالش‌های مسابقه فتح پرچم دانشگاه صنعتی بیرجند

## چالش 1 — اتاق امنیتی
**امتیاز:** 50

### توضیحات
یک ویدیوی کم‌کیفیت از یک اتاق امنیتی پیدا می‌کنید. در این ویدیو، فردی در حال تایپ یک رمز ورود ۴ رقمی به یک صفحه کلید (Keypad) براق است.  
اعداد مستقیماً دیده نمی‌شوند، اما بازتاب نور اثر انگشت‌ها، ترتیب فشار کلیدها را مشخص می‌کند.

اثر انگشت‌ها به ترتیب روی موقعیت‌های زیر دیده می‌شوند:
1. بالا-راست (Top-Right)
2. وسط-چپ (Middle-Left)
3. پایین-چپ (Bottom-Left)
4. وسط-راست (Middle-Right)

❓ سؤال: فلگ چیست؟  
با استفاده از موقعیت‌های بازتاب اثر انگشت روی صفحه کلید استاندارد (1 تا 9)، توالی ۴ رقمی رمز را پیدا کرده و با ساختار استاندارد CTF وارد نمایید.

### راه حل


### فلگ
<div dir="ltr">


</div>

## چالش 2 — سرور قدیمی
**امتیاز:** 150

### توضیحات
پس از نفوذ به سرور قدیمی، تنها یک فایل متنی پیدا کردیم که حاوی یک پیام رمزی و یک پاراگراف عجیب بود. پیام رمزی این بود: Vm0xMFlWbFNXa2xaVnpVemJETldhMDVX

پاراگراف عجیب: آزمایشگر در گزارش خود نوشته است که رمز عبور نخستین کلید بود. اما کدام؟ این به تعداد حروف اولین کلمه در متن اصلی پیام، که برعکس شود، بستگی دارد.

پرچم را پیدا کنید. پرچم در واقع متن ساده‌شدهٔ پیام رمزی است.

### راه حل


### فلگ
<div dir="ltr">


</div>

## چالش 3 — نام دامنه‌
**امتیاز:** 100

### توضیحات
در مدل TCP/IP، کدام لایه مسئول تبدیل نام دامنه‌ی وب‌سایت به آدرس عددی IP است؟

### راه حل


### فلگ
<div dir="ltr">
  
`flag{DNS}`
</div>

## چالش 4 — سیستم میزبان
**امتیاز:** 200

### توضیحات
برای تضمین اینکه یک سیستم میزبان (Host) یک پیام رمزنگاری شده را از مبدأ قابل اعتماد دریافت کرده است، کدام گواهی یا مدرک امنیتی ضروری است؟

### راه حل


### فلگ
<div dir="ltr">


</div>

## چالش 5 — جاسوس
**امتیاز:** 100

### توضیحات
یک جاسوس برای ایجاد یک گذرواژه یک‌بار مصرف، از یک الگوی ریاضی دقیق استفاده کرده است. او هر حرف از رمز عبور چهار حرفی خود را با مربع (Square) شماره موقعیت آن حرف در الفبای انگلیسی (با شروع از A=1) رمزگذاری کرده است.

اعداد رمزگذاری‌شده برای حروف گذرواژه:
<div dir="ltr">

`25, 49, 144, 16`
</div>

❓ سؤال: فلگ چیست؟
پرچم (Flag) این چالش، کلمه انگلیسی چهار حرفی است که از رمزگشایی صحیح این دنباله اعداد به دست می‌آید
### راه حل


### فلگ
<div dir="ltr">


</div>



## چالش 6 — آمازون
**امتیاز:** 200

### توضیحات
یک گروه از هکرها توانسته‌اند یک داده‌ی حیاتی را در یک مخزن S3 آمازون (Amazon S3 Bucket) پنهان کنند. ما می‌دانیم که نام باکت (Bucket Name) حاوی پرچم است و از سه بخش تشکیل شده است:

بخش اول: نام پروژه جاسوسی، که عدد دوازدهم در دنباله‌ی فیبوناچی است.  
بخش دوم: کلمه انگلیسی 'cloud'.  
بخش سوم: آخرین حرف از نام اولین سرویس ابری عمومی که امکان ذخیره‌سازی اشیاء (Object Storage) را فراهم کرد.  
سه بخش با خط تیره (-) از هم جدا شده‌اند.

پرچم (Flag) این چالش، نام کامل باکت است."

### راه حل


### فلگ
<div dir="ltr">


</div>

## چالش 7 — حمله سایبری
**امتیاز:** 150

### توضیحات
در یک حمله سایبری، مهاجم با استفاده از یک خطای زمان‌بندی (Timing Error)، توانست سیستم احراز هویت را دور بزند. ما موفق شدیم فقط یک ردیف از لاگ‌های سرور را که مربوط به این حمله است، بازیابی کنیم.

اطلاعات لاگ:

[2025-11-25 10:17:03.123] ERROR: Authentication failed for user 'guest'.

تحلیلگر ما متوجه شد که پرچم (Flag) در حقیقت تفریق زمان‌های ثبت شده (میلی‌ثانیه‌ها) بین ثانیه و لحظه احراز هویت است، با فرض اینکه لحظه احراز هویت، همان زمان ثبت شده است.

پرچم (Flag) این چالش، عدد صحیح سه‌رقمی است که از میلی‌ثانیه‌های این لاگ به دست می‌آید."

### راه حل


### فلگ
<div dir="ltr">

`flag{123}`
</div>

## چالش 8 — IDS
**امتیاز:** 100

### توضیحات

یک الگوریتم تشخیص نفوذ (IDS) اعداد عجیب زیر را در لاگ‌های سیستمی ثبت کرده است که به نظر می‌رسد زمان شروع یک حمله را نشان می‌دهد. تحلیلگر سیستم ادعا می‌کند که پرچم، ششمین عدد در یک دنباله ریاضی است که این اعداد را تولید کرده و سپس با عدد 13 جمع شده است.

اعداد ثبت‌شده (چهار عدد اول دنباله):
<div dir="ltr">

`2, 3, 5, 7`
</div>

❓ سؤال: فلگ چیست؟
پرچم (Flag) این چالش، عدد نهایی است که از این فرآیند به دست می‌آید.


### راه حل


### فلگ
<div dir="ltr">



</div>

## چالش 9 — سرور آزمایشی
**امتیاز:** 200

### توضیحات
یک سرور آزمایشی راه‌اندازی شده است تا سرویس جدیدی را در یک پورت باز ارائه دهد. ادمین سیستم، پورت را به اشتباه به گونه‌ای پیکربندی کرده است که به‌جای پورت استاندارد HTTP، دو پورت بعد از آن پورت را برای سرویس گوش می‌دهد. با این حال، او در آخرین لحظه پورت استاندارد FTP را از لیست خود حذف کرد و گفت که دیگر نیازی به آن نیست.

پرچم (Flag) این چالش، شماره پورت TCP است که سرور نهایتاً روی آن سرویس جدید را ارائه می‌دهد

### راه حل


### فلگ
<div dir="ltr">

`flag{82}`
</div>

## چالش 10 — جهانگرد مرموز
**امتیاز:** 150

### توضیحات
یک جهانگرد مرموز برای ارسال آخرین موقعیت خود، از یک سیستم رمزگذاری عجیب استفاده کرده است. او در دفترچه یادداشت خود نوشته است: 'به جای مختصات، تنها کافی است نام اولین محلی که پرواز 117 از آشیانه (Hangar) خود به سمت جنوب آغاز کرد را رمزگشایی کنید.'

این محل، یک کلمه انگلیسی شش یا هفت حرفی است.

رمز این محل در یک رشته رمزی Base64 پنهان شده است: U0hBTEFMQ

پرچم (Flag) این جا نام این محل است،

### راه حل


### فلگ
<div dir="ltr">



</div>

## چالش 11 — یادداشت
**امتیاز:** 100

### توضیحات
یک جاسوس سابق، اطلاعات حیاتی را در یک فایل اجرایی کوچک پنهان کرده است. او در یادداشت خود نوشته است که تنها راه برای دیدن پرچم این است که 'این برنامه کوچک را مجبور به گفتن چهارمین حرف رمز عبور کنید.'

رمز عبور اولیه، یک کلمه انگلیسی چهار حرفی بود، اما برنامه آن را به کد ASCII تبدیل کرده و سپس با عدد 1 برای هر حرف، جمع کرده است.

خروجی نهایی برنامه:

<div dir="ltr">

`69 110 102 111`
</div>

پرچم (Flag)، چهارمین حرف رمز عبور انگلیسی اصلی است.


### راه حل


### فلگ
<div dir="ltr">


</div>

## چالش 12 — پایگاه داده آسیب‌دیده
**امتیاز:** 200

### توضیحات
یک پایگاه داده آسیب‌دیده را پیدا می‌کنید که در آن رمزهای عبور کاربران با استفاده از الگوریتم هشینگ MD5 ذخیره شده‌اند. هدف شما این است که ماهیت الگوریتم هش‌سازی را درک کنید تا فلگ را از طریق نامگذاری آن استخراج کنید.

در علم رمزنگاری، یک ویژگی بسیار مهم وجود دارد که الگوریتم‌های هش (مانند MD5، SHA-1 و SHA-256) باید آن را داشته باشند. این ویژگی تضمین می‌کند که تغییر بسیار کوچک (حتی یک بایت) در ورودی، منجر به تغییرات بسیار بزرگ و غیرقابل پیش‌بینی در خروجی هش می‌شود.

قانون استخراج فلگ:

فلگ، نام انگلیسی این خاصیت حیاتی و اجباری الگوریتم‌های هش‌سازی است که تضمین می‌کند تغییر کوچک در ورودی، تغییر بزرگ در خروجی را در پی دارد.
این نام یک کلمه انگلیسی ۹ حرفی است.

❓ سؤال: فلگ چیست؟


### راه حل


### فلگ
<div dir="ltr">


</div>

## چالش 13 — پورتال مدیریت دسترسی 
**امتیاز:** 200

### توضیحات
به یک پورتال مدیریت دسترسی پیدا کرده‌اید. در هنگام ورود، سرور یک کوکی به نام auth_level به مرورگر ارسال می‌کند که سطح دسترسی شما را مشخص می‌کند. شما می‌دانید که برای دسترسی به فلگ، باید سطح دسترسی خود را از کاربر عادی به مدیر ارتقا دهید.

شما کوکی اولیه خود را رهگیری می‌کنید:
<div dir="ltr">

`{Set-Cookie: auth_level=user; Expires=...}`
</div>


شما با بررسی کد منبع سرور متوجه می‌شوید که دو مقدار برای این کوکی در نظر گرفته شده است:

- سطح دسترسی پایین: `{user}` (کاربر)
- سطح دسترسی بالا: `{admin}` (مدیر)

قانون استخراج فلگ:

"فلگ، نام کامل و دستکاری‌شده کوکی است که اگر آن را به مرورگر خود تزریق کنید، مستقیماً دسترسی مدیر را به شما می‌دهد. این فلگ شامل نام کوکی، علامت مساوی و مقدار جدید آن است."

❓ سؤال: فلگ چیست؟

ترکیب دقیق نام کوکی و مقدار جدید آن که سطح دسترسی مدیر را فراهم می‌کند را، با حروف کوچک انگلیسی مانند {name=value} و در ساختار استاندارد CTF وارد نمایید.

### راه حل


### فلگ
<div dir="ltr">



</div>

## چالش 14 — لاگ بزرگ 
**امتیاز:** 200

### توضیحات

یک فایل لاگ بزرگ از فعالیت‌های وب یک جاسوس را بررسی می‌کنید. شما می‌دانید که رمز نهایی، درون یک کوکی (Cookie) که توسط سرور به مرورگر کاربر ارسال شده، پنهان شده است.

قانون استخراج فلگ:

"فلگ، مقدار نام کاربری (Username) است که در اولین کوکی با نام secret_session و با تاریخ انقضای June 2025 پنهان شده است."

شما با جستجو در لاگ، توالی زیر را پیدا می‌کنید:
<div dir="ltr">

`{Set-Cookie: auth_token=98765; Expires=Tue, 10 Nov 2024 10:00:00 GMT}`

`{Set-Cookie: user_id=alpha; Expires=Wed, 10 May 2025 12:00:00 GMT}`

`{Set-Cookie: secret_session=username=agent_zero; Expires=Mon, 10 Jun 2025 14:00:00 GMT}`

`{Set-Cookie: last_visit=1A2B; Expires=Fri, 10 Sep 2025 16:00:00 GMT}`
</div>

❓ سؤال: فلگ چیست؟
با بررسی فایل لاگ، مقدار Username را که در کوکی secret_session و با انقضای مرتبط با ماه June 2025 پنهان شده است، پیدا کرده و با حروف کوچک انگلیسی در ساختار استاندارد CTF وارد نمایید.


### راه حل


### فلگ
<div dir="ltr">



</div>


## چالش 15 — کد سطح پایین 
**امتیاز:** 200

### توضیحات
یک قطعه کد سطح پایین (Assembly-like) پیدا می‌کنید که برای تولید رمزهای یکبار مصرف (OTP) استفاده می‌شود. این کد، رمز نهایی را با استفاده از سه متغیر (ثبات Register) R1، R2 و R3 محاسبه می‌کند.

مقادیر اولیه ثبات‌ها:

<div dir="ltr">

- R1 = 10
- R2 = 5
- R3 = 2
</div>


دنباله دستورات اجرا شده:

MOVE R1, R2  
(مقدار R2 را در R1 کپی کن.)

ADD R2, R3  
(مقدار R3 را به R2 اضافه کن.)

MUL R3, R1  
(مقدار R1 را در R3 ضرب کن.)

فلگ، مقدار نهایی ثبات R3 پس از اجرای کامل این دستورات است.

❓ سؤال: فلگ چیست؟
با اجرای متوالی دستورات اسمبلی بر روی مقادیر اولیه، مقدار نهایی ثبات R3 را پیدا کرده و با ساختار استاندارد CTF وارد نمایید.


### راه حل


### فلگ
<div dir="ltr">



</div>


## چالش 16 — ویندوز xp 
**امتیاز:** 50

### توضیحات
یک کامپیوتر قدیمی ویندوز XP را بررسی می‌کنید که متعلق به یک هکر قدیمی است. هکر عادت داشته است که فرمان‌های مخفی خود را در یک فایل اجرایی پنهان کند و برای اینکه فایلش در میان سایر فایل‌ها جلب توجه نکند، از پرکاربردترین پسوند فایل‌های اجرایی در ویندوز استفاده کرده است.

یادداشت هکر: "برای من مهم نبود که برنامه چه می‌کند، فقط پسوند فایل باید پسوند اجرایی کلاسیک ویندوز می‌بود. فلگ، نام کامل آن پسوند است." راهنمایی: این پسوند یک کلمه سه حرفی انگلیسی است که کوتاه شده عبارت EXEcutable است و هنوز هم رایج‌ترین فرمت اجرایی در ویندوز است.

❓ سؤال: فلگ چیست؟ نام کامل پسوند فایل اجرایی سه حرفی را که رایج‌ترین در سیستم‌عامل ویندوز است، با حروف بزرگ انگلیسی در ساختار استاندارد CTF وارد نمایید.

### راه حل


### فلگ
<div dir="ltr">
  
`flag{exe}`
</div>


## چالش 17 — سازمان مخفی
**امتیاز:** 
100
### توضیحات
یک پیغام رمزگذاری شده از یک سازمان مخفی پیدا می‌کنید که برای پنهان کردن هویت خود، از یک سیستم جایگزینی بسیار ساده و در عین حال گمراه‌کننده استفاده کرده‌اند.

قانون ابهام‌سازی:

هر حرف در کلمه اصلی، با حرفی که در الفبای انگلیسی بلافاصله بعد از آن قرار دارد، جایگزین شده است.
برای رمزگشایی، باید هر حرف را یک گام به عقب ببرید.

پیام رمزگذاری‌شده (Ciphertext):
<div dir="ltr">
    “T Q S F T”
</div>
❓ سؤال: فلگ چیست؟

با اعمال قانون رمزگشایی (جابجایی یک واحد به عقب) بر روی کلمه TQSFT، فلگ نهایی (کلمه ۵ حرفی) را پیدا کرده و با حروف کوچک انگلیسی در ساختار استاندارد CTF و در قالب ساختاری پیام رمزگذاری شده وارد نمایید.
(توجه: حرف بعد از Z دوباره A نیست. این یک شیفت ساده است.)


### راه حل


### فلگ
<div dir="ltr">


</div>


## چالش 18 — مرکز داده فوق محرمانه 
**امتیاز:** 100

### توضیحات
به یک مرکز داده فوق‌محرمانه نفوذ کرده‌اید. برای باز کردن قفل اتاق سرور، باید یک رمز ۹ رقمی را وارد کنید. این رمز در یک فایل صوتی پنهان شده است که هنگام تایپ رمز توسط نگهبان، ضبط شده است.

تحلیلگر صدا یک یادداشت حیاتی را به شما می‌دهد:

"رمز، مستقیماً در تعداد دفعات فشار دادن کلیدها پنهان شده است. تعداد دفعات تکرار هر رقم، متوالی است و از بالاترین فرکانس کلیک (مربوط به رقم بزرگ‌تر) شروع شده و به پایین‌ترین فرکانس کلیک (مربوط به رقم کوچک‌تر) ختم می‌شود."

تجزیه و تحلیل فرکانس‌های کلیک:

| سطح فرکانس         | تعداد کلیک | رقم متناظر |
|--------------------|------------|-------------|
| بالاترین فرکانس    | 4 بار      | 9           |
| فرکانس میانی       | 3 بار      | 7           |
| پایین‌ترین فرکانس  | 2 بار      | 1           |


فلگ، توالی ۹ رقمی است که از کنار هم قرار دادن این ارقام، بر اساس تعداد دفعات تکرارشان، به دست می‌آید.
(مثلاً اگر رقم A دو بار تکرار شود، توالی A A خواهد بود.)

❓ سؤال: فلگ چیست؟
با استفاده از تعداد تکرار هر رقم، توالی ۹ رقمی رمز را پیدا کرده و با ساختار استاندارد CTF وارد نمایید.

### راه حل


### فلگ
<div dir="ltr">


</div>


## چالش 19 — قله 
**امتیاز:** 50

### توضیحات
یک نامه قدیمی پیدا می‌کنید که متعلق به یک سازمان مخفی است. آن‌ها برای پنهان کردن مکان ملاقات خود از کدگذاری استفاده نمی‌کردند، بلکه به یک نقطه عطف جغرافیایی عمومی و شناخته‌شده اشاره می‌کردند.

یادداشت نهایی سازمان این است:

"محل ملاقات، روی قله‌ای است که بلندترین نقطه در یک رشته‌کوه مشهور در ایران محسوب می‌شود. فلگ، نام دقیق این قله است که باید به حروف کوچک انگلیسی و بدون هیچ فاصله یا علامت اضافی وارد شود."

این رشته‌کوه، "بلندترین و معروف‌ترین رشته‌کوه در شمال ایران" است.

❓ سؤال: فلگ چیست؟
نام بلندترین قله در رشته‌کوه البرز را به حروف کوچک انگلیسی (و بدون فاصله) پیدا کرده و با ساختار استاندارد CTF وارد نمایید.

### راه حل


### فلگ
<div dir="ltr">
  
`flag{damavand}`
</div>

## چالش 20 — OTP 
**امتیاز:** 100

### توضیحات
یک قطعه کد بسیار قدیمی پیدا می‌کنید که برای تولید رمزهای یکبار مصرف (OTP) استفاده می‌شده است. این کد، رمز نهایی را با استفاده از یک عملیات بیتی (Bitwise Operation) ساده بر روی یک عدد پایه تولید می‌کند.

رمز پایه (عدد دهدهی):

<div dir="ltr">

`40`
</div>

برنامه‌نویس برای گیج کردن، رمز را اینگونه تعریف کرده است:

"رمز نهایی، نتیجه جابجایی بیتی به راست (Right Shift) عدد پایه، به اندازه یک واحد است. به عبارت دیگر، هر بیت را یک مرتبه به سمت راست حرکت بده و صفرها را از سمت چپ پر کن."

فلگ، عدد دهدهی است که پس از اجرای این عملیات، به دست می‌آید.

❓ سؤال: فلگ چیست؟
با انجام عملیات جابجایی بیتی به راست به اندازه ۱ واحد بر روی عدد دهدهی ۴۰، مقدار دهدهی نهایی (فلگ) را پیدا کرده و با ساختار استاندارد CTF وارد نمایید.

### راه حل


### فلگ
<div dir="ltr">


</div>



</div>
